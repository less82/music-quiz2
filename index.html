<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nolto Music Quiz</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Do+Hyeon&family=Gamja+Flower&family=Jua&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        /* [í…Œë§ˆ] ë†€ë¼ìš´ í† ìš”ì¼ ë ˆíŠ¸ë¡œ ìš°ë“œ ìŠ¤íƒ€ì¼ */
        :root {
            --wood-dark: #3e2723;
            --wood-light: #5d4037;
            --nolto-orange: #ff6f00;
            --nolto-yellow: #ffca28;
            --nolto-bg: #8d6e63;
        }

        * {
            box-sizing: border-box;
        }

        body {
            /* ìš°ë“œ íŒ¨í„´ ë°°ê²½ */
            background-color: var(--wood-dark);
            background-image:
                repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(0, 0, 0, 0.1) 50px, rgba(0, 0, 0, 0.1) 53px),
                linear-gradient(to bottom, rgba(0, 0, 0, 0.2), transparent);
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
            font-family: 'Jua', sans-serif;
            color: #fff;
        }

        /* ìœ íŠœë¸Œ í”Œë ˆì´ì–´ ìˆ¨ê¹€ */
        #hidden-player-wrapper {
            position: absolute;
            bottom: 0;
            right: 0;
            width: 1px;
            height: 1px;
            opacity: 0;
            pointer-events: none;
            z-index: -1;
        }

        /* ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ */
        #system-status {
            position: absolute;
            bottom: 10px;
            right: 20px;
            font-size: 16px;
            color: #ffcc80;
            z-index: 100;
            font-family: 'Do Hyeon', sans-serif;
            text-shadow: 1px 1px 2px #000;
        }

        /* ìŠ¬ë¼ì´ë“œ ì»¨í…Œì´ë„ˆ */
        .slide-container {
            width: 95vw;
            aspect-ratio: 16 / 9;
            max-height: 95vh;
            background: #5d4037;
            border: 15px solid #3e2723;
            border-radius: 20px;
            box-shadow: inset 0 0 50px rgba(0, 0, 0, 0.6), 0 20px 50px rgba(0, 0, 0, 0.8);
            position: relative;
            overflow: hidden;
            display: none;
            flex-direction: column;
            padding: 2vw;
        }

        .slide-container.active {
            display: flex;
            animation: bounceIn 0.5s;
        }

        @keyframes bounceIn {
            0% {
                transform: scale(0.9);
                opacity: 0;
            }

            70% {
                transform: scale(1.02);
                opacity: 1;
            }

            100% {
                transform: scale(1);
            }
        }

        /* [íƒ€ì´í‹€ í™”ë©´] */
        .title-content {
            text-align: center;
            margin: auto;
            background: url('https://www.transparenttextures.com/patterns/black-scales.png'), radial-gradient(circle, #ffca28 0%, #ff6f00 100%);
            padding: 60px;
            border-radius: 50%;
            border: 8px solid #fff;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            width: 60vh;
            height: 60vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .title-text {
            font-family: 'Black Han Sans', sans-serif;
            font-size: 5vw;
            color: #fff;
            text-shadow: 3px 3px 0 #3e2723, -1px -1px 0 #3e2723, 1px -1px 0 #3e2723, -1px 1px 0 #3e2723, 1px 1px 0 #3e2723;
            line-height: 1.1;
            transform: rotate(-5deg);
        }

        /* [ì ìˆ˜íŒ] */
        .board-wrapper {
            background: #fff8e1;
            border-radius: 10px;
            padding: 10px;
            height: 100%;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            border: 2px solid #d7ccc8;
        }

        .board-header {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-bottom: 10px;
            height: 10%;
        }

        .category-title {
            background: #3e2723;
            color: #ffca28;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-size: 1.8vw;
            font-family: 'Black Han Sans', sans-serif;
            border: 2px dashed #ffca28;
            box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.3);
        }

        .board-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            flex-grow: 1;
        }

        .score-column {
            display: grid;
            grid-template-rows: repeat(5, 1fr);
            gap: 10px;
        }

        /* [í¬ìŠ¤íŠ¸ì‡ ë²„íŠ¼] */
        .score-btn {
            background: #ffb74d;
            color: #3e2723;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3vw;
            font-family: 'Do Hyeon', sans-serif;
            text-decoration: none;
            box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.2);
            transform: rotate(-1deg);
            transition: all 0.2s;
            position: relative;
        }

        .score-btn::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            border-width: 0 0 20px 20px;
            border-style: solid;
            border-color: transparent transparent rgba(0, 0, 0, 0.1) transparent;
        }

        .score-btn:hover {
            background: #ffa726;
            transform: scale(1.05) rotate(0deg) translateY(-2px);
            z-index: 10;
        }

        .score-btn.solved {
            background: transparent;
            box-shadow: none;
            border: 2px dashed #d7ccc8;
            color: #d7ccc8;
            pointer-events: none;
            transform: none;
        }

        /* [ë¬¸ì œ í™”ë©´] */
        .question-layout {
            display: flex;
            gap: 2vw;
            height: 100%;
            width: 100%;
        }

        .left-panel {
            flex: 0.8;
            background: #3e2723;
            border: 8px solid #8d6e63;
            border-radius: 15px;
            padding: 2vw;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .q-header {
            color: #fff;
            border-bottom: 2px dashed #a1887f;
            padding-bottom: 15px;
        }

        .audio-wrapper {
            background: rgba(0, 0, 0, 0.3);
            padding: 1.5vw;
            border-radius: 10px;
            text-align: center;
            margin-top: 10px;
        }

        /* [NEW] ë²„íŠ¼ ê·¸ë£¹ ìŠ¤íƒ€ì¼ ìˆ˜ì • */
        .btn-group-time {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-group-play {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .time-btn {
            background: #fff;
            color: #3e2723;
            border: none;
            padding: 10px 0;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.5vw;
            font-family: 'Black Han Sans';
            box-shadow: 0 4px 0 #a1887f;
            transition: 0.1s;
        }

        .time-btn:active {
            transform: translateY(4px);
            box-shadow: none;
        }

        /* ì „ì²´ ì¬ìƒ ë²„íŠ¼ (í•˜ì–€ìƒ‰ ë² ì´ìŠ¤) */
        .full-play-btn {
            background: #fff3e0;
            color: #e65100;
        }

        /* í•˜ì´ë¼ì´íŠ¸ ë²„íŠ¼ (ì˜¤ë Œì§€ìƒ‰) */
        .highlight-btn {
            background: #ff6f00;
            color: white;
            box-shadow: 0 4px 0 #e65100;
        }

        .stop-btn {
            background: #d32f2f;
            color: white;
            margin-top: 10px;
            width: 100%;
            box-shadow: 0 4px 0 #b71c1c;
        }

        .status-text {
            color: #ffd54f;
            font-size: 1.3vw;
            margin-bottom: 5px;
            height: 1.5em;
        }

        .right-panel {
            flex: 1.2;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: radial-gradient(#fff8e1 10%, transparent 11%), radial-gradient(#fff8e1 10%, transparent 11%);
            background-size: 20px 20px;
            background-color: #8d6e63;
            border: 8px solid #5d4037;
            border-radius: 15px;
        }

        .post-it-hint {
            width: 70%;
            aspect-ratio: 1/1;
            background: #ffecb3;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-size: 3vw;
            font-family: 'Black Han Sans';
            color: #3e2723;
            box-shadow: 10px 10px 15px rgba(0, 0, 0, 0.3);
            transform: rotate(-3deg);
            cursor: pointer;
            position: absolute;
            z-index: 20;
            transition: all 0.5s ease-in-out;
            text-align: center;
            padding: 20px;
        }

        .post-it-hint::before {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 150px;
            height: 35px;
            background: rgba(255, 255, 255, 0.4);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .post-it-hint.removed {
            transform: translateY(150%) rotate(45deg);
            opacity: 0;
            pointer-events: none;
        }

        .answer-reveal {
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s 0.3s;
            width: 100%;
            z-index: 10;
        }

        .post-it-hint.removed+.answer-reveal {
            opacity: 1;
        }

        .song-title {
            font-size: 4.5vw;
            color: #ffca28;
            margin-bottom: 10px;
            text-shadow: 3px 3px 0 #3e2723;
            font-family: 'Black Han Sans';
        }

        .artist-name {
            font-size: 2.5vw;
            color: #fff;
            text-shadow: 2px 2px 0 #3e2723;
        }

        .nav-btn {
            background: #5d4037;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-size: 1.2vw;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            border: 2px solid #a1887f;
        }

        .nav-btn:hover {
            background: #6d4c41;
        }

        .reset-btn {
            position: absolute;
            bottom: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #3e2723;
            cursor: pointer;
            font-family: 'Do Hyeon';
            font-size: 1.2rem;
        }
    </style>
</head>

<body>

    <!-- ì‹œìŠ¤í…œ ìƒíƒœ í‘œì‹œ -->
    <div id="system-status">ğŸŸ¡ í”Œë ˆì´ì–´ ë¡œë”© ì¤‘...</div>

    <!-- ìœ íŠœë¸Œ í”Œë ˆì´ì–´ -->
    <div id="hidden-player-wrapper">
        <div id="yt-player"></div>
    </div>

    <!-- 1. íƒ€ì´í‹€ ìŠ¬ë¼ì´ë“œ -->
    <div class="slide-container active" id="title">
        <div class="title-content">
            <div class="title-text">
                <span style="font-size: 3vw; color: #ffca28;">ê°€ì¡±ì˜¤ë½ê´€</span><br>
                ìŒì•… ì¥í•™í€´ì¦ˆ
            </div>
            <div style="margin-top: 40px;">
                <a href="#board" class="nav-btn" style="background: #ff6f00; border-color: #ff6f00; font-size: 1.5vw;">
                    <i class="fa-solid fa-play"></i> ê²Œì„ ì‹œì‘í•˜ê¸°
                </a>
            </div>
            <p style="margin-top: 20px; color: #fff; font-size: 1rem;">* ì†Œë¦¬ê°€ ì•ˆ ë‚˜ë©´ ë³¼ë¥¨ì„ í‚¤ì›Œì£¼ì„¸ìš”</p>
        </div>
    </div>

    <!-- 2. ê²Œì„ ë³´ë“œ ìŠ¬ë¼ì´ë“œ -->
    <div class="slide-container" id="board">
        <div class="board-wrapper">
            <div class="board-header">
                <div class="category-title">ì „êµ­ë¯¼ ë–¼ì°½ê³¡</div>
                <div class="category-title">ìš”ì¦˜ ì• ë“¤ (1020)</div>
                <div class="category-title">ë¼ë–¼ëŠ” (8090)</div>
                <div class="category-title">ë“œë¼ë§ˆ OST</div>
                <div class="category-title">í¥ í­ë°œ</div>
            </div>
            <div class="board-grid" id="score-board-grid"></div>
        </div>
        <button onclick="resetGame()" class="reset-btn"><i class="fa-solid fa-rotate-right"></i> ì „ì²´ ì´ˆê¸°í™”</button>
    </div>

    <!-- JSê°€ ë¬¸ì œ ìŠ¬ë¼ì´ë“œ ìƒì„± -->

    <script>
        // =========================================================================
        // â˜… ë°ì´í„° ì˜ì—­ (ì•ˆì „í•œ IDë¡œ êµì²´ë¨) â˜…
        // =========================================================================
        const quizData = {
            1: {
                category: "ì „êµ­ë¯¼ ë–¼ì°½ê³¡", questions: {
                    10: { title: "ì•„ëª¨ë¥´ íŒŒí‹°", artist: "ê¹€ì—°ì", hint: "ì—°ì• ëŠ” í•„ìˆ˜...", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "o71z6nDktEI", introTime: 0, highlightTime: 42 },
                    20: { title: "ë¶‰ì€ ë…¸ì„", artist: "ì´ë¬¸ì„¸", hint: "ë‚œ ë„ˆë¥¼ ì‚¬ë‘í•´~", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "NfuELl2KZHM", introTime: 0, highlightTime: 31 },
                    30: { title: "ì—¬í–‰ì„ ë– ë‚˜ìš”", artist: "ì¡°ìš©í•„", hint: "ë©”ì•„ë¦¬ ì†Œë¦¬ê°€...", type: "ì „ì£¼ 3ì´ˆ", youtubeId: "eGC5_DHWPh8", introTime: 0, highlightTime: 53 },
                    40: { title: "ì˜ëª»ëœ ë§Œë‚¨", artist: "ê¹€ê±´ëª¨", hint: "ë¹ ë¥¸ ë©", type: "ì „ì£¼ 0.5ì´ˆ", youtubeId: "29kdLgJN_Ds", introTime: 0, highlightTime: 69 },
                    50: { title: "ì•„íŒŒíŠ¸", artist: "ìœ¤ìˆ˜ì¼", hint: "ìœ¼ìƒ¤ë¼ ìœ¼ìƒ¤", type: "ì „ì£¼ 0.5ì´ˆ", youtubeId: "mK7PZZj1cO4", introTime: 1, highlightTime: 35 }
                }
            },
            2: {
                category: "ìš”ì¦˜ ì• ë“¤", questions: {
                    10: { title: "Dynamite", artist: "BTS", hint: "ì˜ì–´ ê°€ì‚¬", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "KhZ5DCd7m6s", introTime: 1, highlightTime: 43 },
                    20: { title: "Love Dive", artist: "IVE", hint: "ìˆ¨ ì°¸ê³ ...", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "qYh3NhMRDjY", introTime: 0, highlightTime: 41 },
                    30: { title: "ìœ¼ë¥´ë ", artist: "EXO", hint: "êµë³µ, ëŠ‘ëŒ€", type: "ì „ì£¼ 3ì´ˆ", youtubeId: "I3dezFzsNss", introTime: 0, highlightTime: 48 },
                    40: { title: "Ditto", artist: "ë‰´ì§„ìŠ¤", hint: "í—ˆë°", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "Km71Rr9K-Bw", introTime: 0, highlightTime: 55 },
                    50: { title: "Next Level", artist: "ì—ìŠ¤íŒŒ", hint: "ã„·ì ì¶¤", type: "ì „ì£¼ 0.5ì´ˆ", youtubeId: "dly3BvtmXbA", introTime: 1, highlightTime: 43 }
                }
            },
            3: {
                category: "ë¼ë–¼ëŠ” (8090)", questions: {
                    10: { title: "ê·¸ëŒ€ì—ê²Œ", artist: "ë¬´í•œê¶¤ë„", hint: "ëŒ€í•™ê°€ìš”ì œ", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "gJqCO8E63-s", introTime: 1, highlightTime: 133 }, // ê·¸ëŒ€ì—ê²ŒëŠ” ì „ì£¼ê°€ ê¹€
                    20: { title: "ì–´ì©Œë‹¤ ë§ˆì£¼ì¹œ ê·¸ëŒ€", artist: "ì†¡ê³¨ë§¤", hint: "ê°•ë ¬í•œ ê¸°íƒ€", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "Jcfi9gOru6k", introTime: 1, highlightTime: 20 },
                    30: { title: "ë‚¨í–‰ì—´ì°¨", artist: "ê¹€ìˆ˜í¬", hint: "ë¹„ ë‚´ë¦¬ëŠ”...", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "t6J3SlDd2E8", introTime: 0, highlightTime: 21 },
                    40: { title: "ë‹´ë‹¤ë””", artist: "ì´ìƒì€", hint: "í‚¤ë‹¤ë¦¬ ì•„ì €ì”¨", type: "ì „ì£¼ 2ì´ˆ", youtubeId: "FIgQCDWEjWc", introTime: 0, highlightTime: 15 },
                    50: { title: "ë‚´ ì‚¬ë‘ ë‚´ ê³ì—", artist: "ê¹€í˜„ì‹", hint: "ì—¬ë¦„", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "gtOVozYocuw", introTime: 0, highlightTime: 116 }
                }
            },
            4: {
                category: "ë°©êµ¬ì„ 1ì—´", questions: {
                    10: { title: "Let It Go", artist: "ê²¨ìš¸ì™•êµ­", hint: "ì—˜ì‚¬", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "moSFlvxnbgk", introTime: 1, highlightTime: 59 },
                    20: { title: "My Destiny", artist: "ë³„ê·¸ëŒ€", hint: "ë„ë¯¼ì¤€", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "UAehQTLXIiQ", introTime: 0, highlightTime: 74 },
                    30: { title: "We All Lie", artist: "SKY ìºìŠ¬", hint: "ì „ì ìœ¼ë¡œ...", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "PdDfuWJc9dA", introTime: 0, highlightTime: 1 },
                    40: { title: "ì•¼ì¸", artist: "ì•¼ì¸ì‹œëŒ€", hint: "4ë”¸ë¼", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "WohwV1dedTc", introTime: 0, highlightTime: 8 },
                    50: { title: "Stay With Me", artist: "ë„ê¹¨ë¹„", hint: "ê²€", type: "ì „ì£¼ 3ì´ˆ", youtubeId: "pcKR0LPwoYs", introTime: 0, highlightTime: 78 }
                }
            },
            5: {
                category: "í¥ í­ë°œ", questions: {
                    10: { title: "ë¬´ì¡°ê±´", artist: "ë°•ìƒì² ", hint: "ì§œì§œë¼...", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "G_KNxk_q8PU", introTime: 0, highlightTime: 72 },
                    20: { title: "ì°ì´ì•¼", artist: "ì˜íƒ", hint: "ì—„ì§€ ì²™", type: "ì „ì£¼ 1ì´ˆ", youtubeId: "SiQzf2MyHl0", introTime: 0, highlightTime: 14 },
                    30: { title: "DOCì™€ ì¶¤ì„", artist: "DJ DOC", hint: "ê´€ê´‘ë²„ìŠ¤", type: "ì „ì£¼ 3ì´ˆ", youtubeId: "s3lzt08qGkw", introTime: 0, highlightTime: 75 },
                    40: { title: "ì‚¬ë‘ì˜ ë°°í„°ë¦¬", artist: "í™ì§„ì˜", hint: "ë‹¹ì‹ ì´ ì§±", type: "ì „ì£¼ 0.5ì´ˆ", youtubeId: "GfMhBAhmkno", introTime: 1, highlightTime: 16 },
                    50: { title: "í…ŒìŠ¤í˜•!", artist: "ë‚˜í›ˆì•„", hint: "ì„¸ìƒì´ ì™œ ì´ë˜", type: "ì „ì£¼ 0.5ì´ˆ", youtubeId: "MRrXRlVd0P0", introTime: 0, highlightTime: 70 }
                }
            }
        };

        // =========================================================================
        // ìœ íŠœë¸Œ ë¡œì§
        // =========================================================================
        var player;
        var isPlayerReady = false;
        var currentTimer = null;

        var tag = document.createElement('script');
        tag.src = "https://www.youtube.com/iframe_api";
        var firstScriptTag = document.getElementsByTagName('script')[0];
        firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('yt-player', {
                height: '10', width: '10',
                playerVars: { 'playsinline': 1, 'controls': 0 },
                events: { 'onReady': onPlayerReady }
            });
        }

        function onPlayerReady(event) {
            isPlayerReady = true;
            const statusEl = document.getElementById('system-status');
            if (statusEl) {
                statusEl.innerText = "ğŸŸ¢ ì¤€ë¹„ ì™„ë£Œ! (ì†Œë¦¬ë¥¼ ì¼œì£¼ì„¸ìš”)";
                statusEl.style.color = "#b2dfdb";
            }
        }

        function playSnippet(youtubeId, startTime, duration, statusId) {
            if (!isPlayerReady) { alert("í”Œë ˆì´ì–´ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì ì‹œë§Œìš”!"); return; }

            const statusEl = document.getElementById(statusId);

            // ìƒíƒœ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
            if (statusEl) {
                if (duration === 'full') statusEl.innerText = "ì „ì²´ ì¬ìƒ ì¤‘...";
                else if (duration === 'highlight') statusEl.innerText = "í•˜ì´ë¼ì´íŠ¸ ì¬ìƒ ì¤‘!";
                else statusEl.innerText = duration + "ì´ˆ ì¬ìƒ ì¤‘...";
            }

            stopVideo(statusId, false); // í…ìŠ¤íŠ¸ ì´ˆê¸°í™” ì•ˆ í•¨

            player.loadVideoById({ videoId: youtubeId, startSeconds: startTime });
            setTimeout(() => { player.playVideo(); }, 100);

            if (duration !== 'full' && duration !== 'highlight') {
                currentTimer = setTimeout(() => {
                    player.pauseVideo();
                    if (statusEl) statusEl.innerText = "ì‹œê°„ ì¢…ë£Œ!";
                }, duration * 1000);
            }
        }

        function stopVideo(statusId, clearText = true) {
            if (currentTimer) { clearTimeout(currentTimer); currentTimer = null; }
            if (player && isPlayerReady) player.pauseVideo();

            if (clearText && statusId) {
                const statusEl = document.getElementById(statusId);
                if (statusEl) statusEl.innerText = "";
            }
        }

        // =========================================================================
        // UI ìƒì„±
        // =========================================================================
        document.addEventListener("DOMContentLoaded", () => {
            generateBoard();
            generateQuestionSlides();
            loadBoardState();
            handleNavigation();
        });

        window.addEventListener('hashchange', handleNavigation);

        function handleNavigation() {
            const hash = window.location.hash || '#title';
            const targetId = hash.substring(1);
            stopVideo();
            document.querySelectorAll('.slide-container').forEach(slide => slide.classList.remove('active'));
            const targetSlide = document.getElementById(targetId) || document.getElementById('title');
            targetSlide.classList.add('active');
        }

        function generateBoard() {
            const grid = document.getElementById('score-board-grid');
            for (let col = 1; col <= 5; col++) {
                const colDiv = document.createElement('div');
                colDiv.className = 'score-column';
                for (let score = 10; score <= 50; score += 10) {
                    const btn = document.createElement('a');
                    btn.className = 'score-btn';
                    btn.id = `btn-${col}-${score}`;
                    btn.href = `#q-${col}-${score}`;
                    btn.innerText = score;
                    btn.onclick = () => markSolved(`btn-${col}-${score}`);
                    colDiv.appendChild(btn);
                }
                grid.appendChild(colDiv);
            }
        }

        function generateQuestionSlides() {
            for (let col = 1; col <= 5; col++) {
                for (let score = 10; score <= 50; score += 10) {
                    const data = quizData[col].questions[score];
                    if (!data) continue;

                    const slide = document.createElement('div');
                    slide.className = 'slide-container';
                    slide.id = `q-${col}-${score}`;
                    const statusId = `status-${col}-${score}`;

                    const intro = data.introTime !== undefined ? data.introTime : 0;
                    const highlight = data.highlightTime !== undefined ? data.highlightTime : 60;

                    slide.innerHTML = `
                    <div class="question-layout">
                        <div class="left-panel">
                            <div>
                                <h2 class="q-header">${quizData[col].category} <span style="font-size:0.7em; color:#ffcc80;">(${score}ì )</span></h2>
                                <div class="audio-wrapper">
                                    <div id="${statusId}" class="status-text"></div>
                                    
                                    <p style="margin:5px 0; color:#bcaaa4; font-size:1.2vw;">[ìŒì•… ì»¨íŠ¸ë¡¤]</p>
                                    
                                    <!-- ì‹œê°„ ì¡°ì ˆ ë²„íŠ¼ (1ì´ˆ, 2ì´ˆ, 3ì´ˆ) -->
                                    <div class="btn-group-time">
                                        <button class="time-btn" onclick="playSnippet('${data.youtubeId}', ${intro}, 1, '${statusId}')">1ì´ˆ</button>
                                        <button class="time-btn" onclick="playSnippet('${data.youtubeId}', ${intro}, 2, '${statusId}')">2ì´ˆ</button>
                                        <button class="time-btn" onclick="playSnippet('${data.youtubeId}', ${intro}, 3, '${statusId}')">3ì´ˆ</button>
                                    </div>

                                    <!-- ì „ì²´ ì¬ìƒ & í•˜ì´ë¼ì´íŠ¸ -->
                                    <div class="btn-group-play">
                                        <button class="time-btn full-play-btn" onclick="playSnippet('${data.youtubeId}', ${intro}, 'full', '${statusId}')">
                                            <i class="fa-solid fa-play"></i> ì „ì²´ ì¬ìƒ
                                        </button>
                                        <button class="time-btn highlight-btn" onclick="playSnippet('${data.youtubeId}', ${highlight}, 'highlight', '${statusId}')">
                                            <i class="fa-solid fa-star"></i> í•˜ì´ë¼ì´íŠ¸
                                        </button>
                                    </div>
                                    
                                    <button class="time-btn stop-btn" onclick="stopVideo('${statusId}')">ì •ì§€</button>
                                </div>
                            </div>
                            
                            <div>
                                <a href="#board" class="nav-btn" onclick="loadBoardState()">
                                    <i class="fa-solid fa-list"></i> ëª©ë¡ìœ¼ë¡œ
                                </a>
                            </div>
                        </div>

                        <div class="right-panel">
                            <div class="post-it-hint" onclick="removePostIt(this)">
                                <div style="font-size: 1.5vw; color: #5d4037; margin-bottom: 10px;">HINT</div>
                                <div>${data.hint}</div>
                            </div>

                            <div class="answer-reveal">
                                <div class="song-title">${data.title}</div>
                                <div class="artist-name">${data.artist}</div>
                                <div style="margin-top: 30px; font-size: 5vw; color: #ffca28;">
                                    <i class="fa-solid fa-music fa-bounce"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                    document.body.appendChild(slide);
                }
            }
        }

        function markSolved(id) { sessionStorage.setItem(id, 'solved'); }
        function loadBoardState() {
            document.querySelectorAll('.score-btn').forEach(btn => {
                if (sessionStorage.getItem(btn.id) === 'solved') btn.classList.add('solved');
            });
        }
        function removePostIt(el) { el.classList.add('removed'); }
        function resetGame() { if (confirm('ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) { sessionStorage.clear(); location.reload(); } }
    </script>

</body>

</html>
